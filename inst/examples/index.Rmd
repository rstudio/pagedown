---
title: "pagedown: Create Paged HTML Documents for Printing from R Markdown"
shorttitle: "Printing R Markdown with CSS"
author: "Yihui Xie and Romain Lesur"
date: '`r Sys.Date()`'
subtitle: A Less Traveled Road to PDF and Printing
output:
  pagedown::html_paged: 
    toc: true
    self_contained: false
toc-title: Contents
paged-footnotes: true
lot: true
lof: true
bibliography: index.bib
---

# Introduction

When talking about PDF and printing, we often think of tools like LaTeX and Microsoft Word. When talking about HTML and CSS, we may have never imagined their possible off-screen use such as printing to PDF.

Can we print a book with HTML and CSS? W3C published [the first working draft](https://www.w3.org/1999/06/WD-css3-page-19990623) on "Paged Media Properties for CSS(3)", which was last updated in 2013. Although the working draft has been there for nearly two decades, it is still not common to see authors write or print books with HTML and CSS. The main reason is that the W3C specs are still in the draft mode, so most web browsers have not really implemented them.

HTML and CSS still cannot beat other dominating tools like Word or LaTeX when it comes to typesetting content under the constraint of "pages". You may be disappointed by a lot of typesetting details on a paged HTML page. However, HTML and CSS can be extremely powerful and flexible in other aspects, especially when combined with the power of JavaScript. By the way, HTML works almost anywhere because it only requires a web browser.

Although most web browsers have not implemented the W3C specs for Paged Media, a JavaScript polyfill library named ["paged.js"](https://www.pagedmedia.org/paged-js/) is currently being developed to fill the gap. This library is still experimental and has many rough edges, but looks promising enough to us, so we created an R package **pagedown** [@R-pagedown] based on this JavaScript library to paginate the HTML output of R Markdown documents. You can install the package [from Github](https://github.com/rstudio/pagedown):

```{r, eval=FALSE}
remotes::install_github('rstudio/pagedown')
```

To learn more about paged.js and CSS for Paged Media, you may check out [the cheatsheet of paged.js](https://www.pagedmedia.org/about-paged-media/pagedjs-cheatsheet/).

The **pagedown** package contains output formats for paged HTML documents, letters, resumes, posters, business cards, and so on. Usually there is an R Markdown template for each output format, which you can access from RStudio's menu `File -> New File -> R Markdown -> From Template`.


# Paged HTML documents {#pagedjs data-short-title="Paged documents"}

To create a paged HTML document, you can use the output format `pagedown::html_paged`, e.g.,

```yaml
output:
  pagedown::html_paged: 
    toc: true
    number_sections: false
```

## Preview paged HTML documents

This format is based on paged.js. Some other formats in this package are extensions of `html_paged`, such as `html_letter` and `html_resume`. Please note that you need a web server to view the output pages of these formats, because paged.js requires a web server. The web server could be either a local server or a remote one. When you compile an R Markdown document to HTML in RStudio, RStudio will display the HTML page through a local web server, so paged.js will work in RStudio Viewer. However, when you view such pages in a real web browser, you will need a separate web server. The easiest way to preview these HTML pages in a web browser may be through the RStudio addin "Infinite Moon Reader", which requires the **xaringan** package [@R-xaringan]. Or equivalently, you can call the function `xaringan::inf_mr()`. This will launch a local web server via the **servr** package [@R-servr].

Please note that the layout of the pages is very sensitive to the zoom level in your browser. Elements on a page are often not zoomed strictly linearly, e.g., as you zoom out, certainly elements may start to collapse into each other. The 100% zoom level usually gives the best result (press `Ctrl + 0` or `Command + 0`). You are strongly recommended to use this level when printing the page to PDF.

## The CSS overriding mechanism

We have provided a few default CSS stylesheets in this output format:

```yaml
output:
  pagedown::html_paged: 
    css: ["default-fonts", "default-page", "default"]
```

To find the actual CSS files behind these names, use `pagedown:::list_css()`. For example, `default-fonts` means the file `resources/css/default-fonts.css` in the installation directory of **pagedown**. The stylesheet `default-fonts` defines the typefaces of the document, `default-page` defines some page properties (such as the page size, running headers and footers, and rules for page breaks), and `default` defines the style of various elements (such as the table of contents).

If you do not like any of these default stylesheets, you can use a subset of them, or override certain CSS rules. For example, if you do not like the default typeface, you may create a CSS file `my-fonts.css` (assuming it is under the same directory of your Rmd file):

```css
body {
  font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
}
```

Then include this CSS file via the `css` option:

```yaml
output:
  pagedown::html_paged: 
    css: ["my-fonts.css", "default-page", "default"]
```

Note that this overriding mechanism also works for other output formats in **pagedown**.

## Print to PDF

You can print HTML pages to PDF using Google Chrome or Chromium using the menu "Print" or by pressing `Ctrl + P` (or `Command + P` on macOS). Remember to allow background graphics to be printed. You may also consider using the function `pagedown::chrome_print()`, but currently it is experimental and you may get an incomplete PDF, so we recommend that you open the page in a real browser and print to PDF there instead.


# Applications 

## Resume

Currently **pagedown** has one resume format: `pagedown::html_resume`. See https://pagedown.rbind.io/html-resume/ for an example.

```{r, resume-relaxed, echo=FALSE, fig.cap='The HTML resume in pagedown.'}
knitr::include_graphics('https://user-images.githubusercontent.com/163582/49983676-c940a880-ff29-11e8-9487-3b4c94614fcc.png')
```


The R Markdown source document should contain two parts titled "Aside" (for the sidebar) and "Main" (for the main body), respectively. Each part can contain any numbers of sections (e.g., education background and working experience). Each section can contain any numbers of subsections, and you can write more content in a subsection.^[In case you are not very familiar with the Markdown syntax for section headings, a series of `=` under a heading is equivalent to `#` before a heading, and a series of `-` is equivalent to `##`. See Pandoc's manual for details: https://pandoc.org/MANUAL.html#headers.] Below is a quick example:

```markdown
---
title: "Someone's resume"
author: Your Name
output: pagedown::html_resume
---


Aside
====================================

Picture, etc.

Contact info
------------------------------------

Email, phone number, ...

Skills
------------------------------------

- One
- Two
- Three

Disclaimer
------------------------------------

A footer in the sidebar.


Main
====================================

Your Name {#title}
------------------------------------

Arbitrary content.

Education {data-icon=graduation-cap}
------------------------------------

### University One

Title

Location

Year

Arbitrary content

### University Two

...
```

The "Aside" part will be displayed in the right sidebar. This part can contain arbitrary content (not necessarily structured). For example, you can include a picture in the beginning. The "Disclaimer" section will be placed at the bottom of the first page. All icons for this resume template are from [Font Awesome](https://fontawesome.com). For example, `<i class="fa fa-envelope"></i>` will generate an envelope icon. You can look up all icon names on the Font Awesome website if you want to use other icons.

For the "Main" part, all sections must follow a specific structure except the first section. The first section usually shows your name and information that you want to highlight. For the rest of sections, they should contain a title and a number of subsections. You can specify an icon for a section title via the attribute `data-icon`, e.g., `{data-icon=graduation-cap}` means an icon of a graduation cap (which can be used as a symbol for education). For each subsection, it should contain a title, followed by at least three paragraphs:

- The first paragraph is a brief description of the subsection.

- The second paragraph is the location.

- The third paragraph is the time period. If this subsection has both a starting and ending time, separate them by a dash, e.g., `2014 - 2015` or `2014/07/27 - 2015/07/23`.

The description, location, and time period can each be `N/A` if the relevant information is not available.

You can write artibrary content after the third paragraph (e.g., more paragraphs, bullet lists, and so on). If you want to write content in two columns, you may use a "concise" block, e.g.,

```markdown
::: concise
- Taught R language to beginners. 
- Wrote Shiny app demos.
- Converted statistical tutorials from SPSS to R language.
:::
```

If you want to write a side note, use an "aside" block, e.g.,

```markdown
Section
---------------

### Subsection

Title

Location

Year

More info

::: aside
Some notes in the sidebar.
:::
```

```{r, resume-sidenote, echo=FALSE, fig.cap='An example of side notes.'}
knitr::include_graphics('https://user-images.githubusercontent.com/163582/50015125-654ecc00-ff8b-11e8-95be-fc6af8e4a66e.png')
```

There is a caveat about page breaks. By default, we allow page breaks within a subsection. Sometimes this may lead to odd output like the example in Figure \@ref(fig:break-yes). The first bullet should not be split into two columns, and the rest of bullets should have a larger left margin.

```{r, break-yes, echo=FALSE, fig.cap='Allow page breaks in a subsection.'}
knitr::include_graphics('https://user-images.githubusercontent.com/163582/49983264-520a1500-ff27-11e8-8537-66a642f617c3.png')
```

If you want to avoid layout problems like this, you may disallow page breaks via CSS:


```css
.blocks {
  break-inside: avoid;
}
```

However, this may lead to a new issue demonstrated in Figure \@ref(fig:break-no): there may be a large bottom margin on the previous page. At this point, you may start to miss your old friends, Word and LaTeX.

```{r, break-no, echo=FALSE, fig.cap='Do not allow page breaks in a subsection.'}
knitr::include_graphics('https://user-images.githubusercontent.com/163582/49983263-520a1500-ff27-11e8-8e71-cbc69ccfbc6e.png')
```

## Poster

You can create a poster with the output format `pagedown::poster_relaxed` or `pagedown::poster_jacobs`. See https://pagedown.rbind.io/poster-relaxed/ and https://pagedown.rbind.io/poster-jacobs/ for examples.

We do not have time to document the poster formats yet, but here is a caveat: the layout of poster sections is hardcoded in CSS styleseets, which means you cannot add/delete sections unless you know CSS (in particular, CSS Grid Layout). If you are interested in learning CSS Grid Layout, you may take a look at [the CSS of `poster_jacobs`](https://github.com/rstudio/pagedown/blob/master/inst/resources/css/poster-jacobs.css).

### The ReLaXed style

### The Jacobs University style

## Business card

To create a simple business card, you can use the `pagedown::business_card` format. See https://pagedown.rbind.io/business-card/ for an example.

### Single card

A single business card can be created with the following R Markdown file (this file contains only a YAML header).

```yaml
---
name: Jane Doe
title: Miss Nobody
phone: "+1 123-456-7890"
email: "jane.doe@example.com"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
output: pagedown::business_card
---
```

You can repeat the card on multiple pages using the `repeat` variable. The following example produces as many pages as cards (12).

```yaml
---
name: Jane Doe
title: Miss Nobody
phone: "+1 123-456-7890"
email: "jane.doe@example.com"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
repeat: 12
output: pagedown::business_card
---
```

In order to print the cards, you may prefer a layout with several cards on the same page: you can adjust the paper size with the `paperwidth` and `paperheight` variables and define a grid layout with the `cols` and `rows` variables (you may test some combinations of these parameters to find the most appropriate one).

```yaml
---
name: Jane Doe
title: Miss Nobody
phone: "+1 123-456-7890"
email: "jane.doe@example.com"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
repeat: 12
paperwidth: 8.5in
paperheight: 11in
cols: 4
rows: 3
output: pagedown::business_card
---
```

You also can use markdown to define a card. Be aware to use the `slot` attributes as follows.

```markdown
---
logo: "logo.png"
paperwidth: 8.5in
paperheight: 11in
cols: 4
rows: 3
output: pagedown::business_card
---

::::: {.wrapper data-repeat="12"}
[Jane Doe]{slot="name"}
[Miss Nobody]{slot="title"}
[+1 123-456-7890]{slot="phone"}
[jane.doe@example.com]{slot="email"}
[www.example.com]{slot="url"}

::: {.address slot="address"}
2020 South Street
Sunshine, CA 90000
:::
:::::
```

### Different cards with shared informations

You can produce business cards for members of an organization sharing some informations (address, website...).  
Common informations are declared as top level variables in the YAML header. Custom cards are defined using the `person` variable: each `key: value` pair of a `person` block overrides the corresponding top level pair.

```yaml
---
phone: "+1 123-456-7890"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
person:
  - name: Jane Doe
    title: Miss Nobody
    email: "jane.doe@example.com"
    repeat: 6
  - name: John Doe
    title: Mister Nobody
    phone: "+1 777-777-7777" # overrides the default phone
    email: "john.doe@example.com"
    repeat: 6
paperwidth: 8.5in
paperheight: 11in
cols: 4
rows: 3
output: pagedown::business_card
---
```

If you prefer, you can use markdown to create a card as follows.

```markdown
---
name: Jane Doe
title: Miss Nobody
phone: "+1 123-456-7890"
email: "jane.doe@example.com"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
repeat: 6
paperwidth: 8.5in
paperheight: 11in
cols: 4
rows: 3
output: pagedown::business_card
---

::: {.wrapper data-repeat="6"}
[John Doe]{slot="name"}
[Mister Nobody]{slot="title"}
[+1 777-777-7777]{slot="phone"}
[john.doe@example.com]{slot="email"}
[my.domain.com]{slot="url"}
:::
```

### Styling business cards

#### Fonts

You can change the text font with the `mainfont` and/or `googlefonts` top level YAML variables:

- `mainfont` will use the local font installed on your computer, e.g.
  ```yaml
  ---
  name: Jane Doe
  title: Miss Nobody
  phone: "+1 123-456-7890"
  email: "jane.doe@example.com"
  url: www.example.com
  address: |
    2020 South Street
    Sunshine, CA 90000
  logo: "logo.png"
  mainfont: Arial
  output: pagedown::business_card
  ---
  ```

- `googlefonts` to use fonts from https://fonts.google.com, e.g.
  ```yaml
  ---
  name: Jane Doe
  title: Miss Nobody
  phone: "+1 123-456-7890"
  email: "jane.doe@example.com"
  url: www.example.com
  address: |
    2020 South Street
    Sunshine, CA 90000
  logo: "logo.png"
  googlefonts: ["Roboto Condensed", "Raleway"]
  output: pagedown::business_card
  ---
  ```

#### Card sizing

You can modify the card size with the `cardwidth` and `cardheight` variables. You can get a landscape card with:

```yaml
---
name: Jane Doe
title: Miss Nobody
phone: "+1 123-456-7890"
email: "jane.doe@example.com"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
cardwidth: 3.5in
cardheight: 2in
output: pagedown::business_card
---
```

If you render this card, you will see that the default style does not suit well with a landscape card. Read the next section to find an example of a landscape card with a better style.

#### CSS

Finally, you can modify the style of the card using CSS rules.  
The markup of a card can be represented as follows^[This is technically incorrect since the card template use a shadow DOM.]:

```html
<div class="wrapper" data-repeat="1">
  <img class="logo" src="logo.png" alt="Logo" />
  <div class="me">
    <div class="name"><span>Jane Doe</span></div>
    <div class="title"><span>Miss Nobody</span></div>
    <div class="coordinates">
      <p class="phone"><span>+1 123-456-7890</span></p>
      <p class="contact-email"><span>jane.doe@example.com</span></p>
      <p class="website"><span>www.example.com</span></p>
      <div class="address">2020 South Street Sunshine, CA 90000</div>
    </div>
  </div>
</div>
```

You can use these built-in classes to style your card with CSS.  
A landscape card could be styled like this:

~~~markdown
---
name: Jane Doe
title: Miss Nobody
phone: "+1 123-456-7890"
email: "jane.doe@example.com"
url: www.example.com
address: |
  2020 South Street
  Sunshine, CA 90000
logo: "logo.png"
cardwidth: 3.5in
cardheight: 2in
output: pagedown::business_card
---

`r ''````{css}
.logo {
  display: block;
  height: 20%;
  margin-right: .3in;
  padding: .3in 0 0;
  float: right;
}
.name {
  margin-top: .1in;
}
```
~~~

## Letter

You can write a letter with the `pagedown::html_letter` format. See https://pagedown.rbind.io/html-letter/ for an example.

## A Journal of Statistical Software article

You can write an article for the [Journal of Statistical Sofware](https://jstatsoft.org/). See https://pagedown.rbind.io/jss-paged/ for an example. 

# Miscellaneous features

## Lists of tables and figures

Lists of tables and/or figures can be inserted in the document using the `lot` and `lof` variables in the YAML metadata. You also can customize their titles with the `lot-title` and `lof-title` variables. For instance:

```yaml
---
title: "A document with lists of tables and figures"
output: pagedown::html_paged
toc-title: Contents

lot: true
# default: "List of Tables"
lot-title: "Tables"

lof: true
# default: "List of Figures"
lof-title: "Figures"
---
```

## Front matter

By default, the front matter is composed of the cover, the table of contents and the lists of figures and tables if any. The only difference between the front matter pages and the main content pages is the style of the page numbers.

You can add extra sections to the front matter using the `front-matter` class. For instance, if you want to add a preface to the front matter, you need to write:

```markdown
# Preface {.front-matter .unnumbered}
```

## Links

In Markdown, the usual ways to insert links are _automatic_ and _inline_ links.

### Automatic links

Automatic links are created using pointy brackets, e.g., `<https://bookdown.org>`. The full URL is then inserted in the final document <https://bookdown.org>. This is convenient for a short and meaningful URL.

### Inline links

Inline links are useful when you do not want to show the full URL but an alternative text (because URLs are usually long and ugly). In Markdown, the link text is inserted in square brackets and the URL in parentheses, e.g. `[bookdown website](https://bookdown.org)`. On a website, the URL is hidden and replaced by the link text: [bookdown website](). The user can interactively access the URL by clicking on the link. 

When printing a document, we lose interactivity. So we need to show the hidden URLs. By default, the `html_paged` format adds the URLs after the link text in parentheses, for instance `[bookdown website](https://bookdown.org)` is rendered as [bookdown website](https://bookdown.org).

You also can use the `links-to-footnotes` top-level YAML parameter: it transforms all the URLs to footnotes. You will get the same result as `bookdown website^[https://bookdown.org]`. To activate the `links-to-footnotes` option, insert `links-to-footnotes: true` in the YAML header. For instance:

```yaml
---
title: "A paged HTML document"
output: pagedown::html_paged
links-to-footnotes: true
---
```

## Footnotes

The default behavior of pagedown is to render notes as endnotes because Paged.js does not natively support footnotes for now. However, we introduced an experimental support for footnotes. You can test it by including `paged-footnotes: true` in the YAML header of your document. If you get any trouble with this experimental feature, please open an issue in the **pagedown** repository on GitHub.

## Custom running headers {data-short-title="Running headers"}

Sometimes a section title may be too long to fit the header or footer area. In this case, you can specify a shorter title for the running headers/footers via the attribute `data-short-title` after a title, e.g.,

```markdown
## The actual long long long title {data-short-title="An alternative title"}
```

## MathJax

The following test comes from <http://www.cs.toronto.edu/~yujiali/test/mathjax.html>.

Some RBM stuff:

$$
  E(\mathbf{v}, \mathbf{h}) = -\sum_{i,j}w_{ij}v_i h_j - \sum_i b_i v_i - \sum_j c_j h_j
$$

Multiline equations:

$$
  \begin{align}
    p(v_i=1|\mathbf{h}) & = \sigma\left(\sum_j w_{ij}h_j + b_i\right) \\
    p(h_j=1|\mathbf{v}) & = \sigma\left(\sum_i w_{ij}v_i + c_j\right)
  \end{align}
$$

Here is an example of an inline expression: $p(x|y) = \frac{p(y|x)p(x)}{p(y)}$.

## Page references

Internal links will be followed by page numbers by default. For example, you can refer to another section using either `[Section Title]` or `[Link Text](#section-id)` (where `section-id` is the ID of the section header).

Do you still remember [Paged.js](#pagedjs) that we mentioned earlier?

## Figures and tables

Table \@ref(tab:test-table):

```{r, test-table}
knitr::kable(head(iris[, -5]), caption = 'An example table.')
```

# (APPENDIX) Appendix {-} 

# Develop a custom pagedown template{data-short-title="- Custom templates"}

This short guide provides a few tips for starting a new custom pagedown template. 

## Development environment

You need an internet connection, a recent Chromium or Chrome browser and Pandoc â‰¥ 2.2.3. If you use RStudio, you are recommended to install the [last preview of RStudio 1.2.x](https://www.rstudio.com/products/rstudio/download/preview/), which has bundled Pandoc 2.x. You also need to install the development version of pagedown with `remotes::install_github('rstudio/pagedown')` and the last version of xaringan.

You will use two different environments: your favorite IDE (RStudio or any other one) to edit the source files and the Chrome Developers Tools to inspect HTML and experiment some CSS rules. If you are not familiar with the Chrome Developer Tools, you can find some introductive materials here: <https://developers.google.com/web/tools/chrome-devtools/>.

## Project setup (with RStudio)

Start a new RStudio project dedicated to the development of your template. Do not forget to use a control version system. The fastest way to start working on your new template is to modify the default stylesheets of `pagedown::html_paged`. So, you will need an `Rmd` file and the default CSS stylesheets.

Create a new `Rmd` file using the _Paged HTML Document_ template (see the [introduction]).  
Modify the output variable of the YAML header as follows:

```yaml
output:
  pagedown::html_paged:
    css:
    - custom-fonts.css
    - custom-page.css
    - custom.css
    toc: true
    self_contained: false
```

You can modify the content of this `Rmd` file. 

Create a copy of the default CSS files:

```{r, eval=FALSE}
files <- c("default-fonts", "default-page", "default")
from <- pagedown:::pkg_resource(paste0("css/", files, ".css"))
to <- c("custom-fonts.css", "custom-page.css", "custom.css")
file.copy(from = from, to = to)
```

In RStudio, run `xaringan::inf_mr()`. In the R Console, a message ending with a url appears:

```bash
Serving the directory /home/romain/Documents/my_template at http://127.0.0.1:7343/index.html
```

Copy this url and open it in Chromium or Chrome. Back in RStudio, click on the button _Clear all viewer items_ of the viewer (and answer _Yes_). Now, you will edit the CSS files and inspect the result in Chrome.

## Modify the fonts

The first step is to modify the `custom-fonts.css` file. We recommend to use freely available CDN-hosted fonts (e.g. Google Fonts, Adobe Egde Web Fonts...).

## Choose the paper size

Open the `custom-page.css` file. The first CSS rule you can see is:

```css
@page {
  size: 6in 9in;
}
```

For instance, if you prefer a US Letter-size paper, write:

```css
@page {
  size: 8.5in 11in;
}
```

Modifying the paper size can mess the result you see in Chrome. This is because the paginated document is presented in a CSS viewer.

## Adjust the CSS viewer parameters

Now, open the `custom.css` file. The first lines you see are CSS variables declarations^[RStudio does not recognize these declarations and raises false warnings in the margin of the editor.]:

```css
:root {
  --background: whitesmoke;
  --pagedjs-width: 6in;
  --pagedjs-height: 9in;
  --color-paper: white;
  --color-mbox: rgba(0, 0, 0, 0.2);
  --running-title-width: 2.5in;
  --screen-pages-spacing: 5mm;
}
```

According to the paper size you just defined, modify the `--pagedjs-width` and `--pagedjs-height` values.  
You can also modify the background color of the viewer with the `--background` variable^[for further customization of the viewer, see the media queries declarations at the very end of the `custom.css` file.].

## Margins customizations

Go back to the `custom-page.css` file.  

This is the very specific part of CSS Paged Media: plan a good amount of time to learn some new cool features. 

The Paged.js team wrote a great introduction here: https://www.pagedmedia.org/paged-js/  
Read this document, modify the content of the `custom-page.css` file and have fun!  
_Do not forget to commit frequently..._

## Front page customization

Depending on the design of the front page, this step might be highly time consuming: some designs (e.g. <https://bit.ly/pulpdown>) can take several days of work.  

But you also can get nice results in a minute. For instance, you can use a gradient background image. This one will give a sunrise effect to your front page:

```css
@page :first {
  background: linear-gradient(to top, #355C7D 30%, #6C5B7B, #C06C84, #F67280, #F8B195);
}
```

If you want to implement a specific design, you will surely be disappointed by the default HTML markup of `pagedown::html_paged()`.  
**Do not hesitate to customize the default Pandoc template!**

First, copy the default template in your project:

```{r, eval=FALSE}
file.copy(
  pagedown:::pkg_resource("html", "paged.html"), 
  "custom_template.html"
)
```

Then, modify the YAML header of your Rmd file:

```yaml
output:
  pagedown::html_paged:
    template: custom_template.html
    css:
    - custom-fonts.css
    - custom-page.css
    - custom.css
    toc: true
    self_contained: false
```

Now, you can open the `custom_template.html` file and customize the HTML markup.

## Citations styling

If you need to style citations, use the `csl` parameter of `pagedown::html_paged` to pass the link to a CSL file.  
For example, if you want to use the APA citation style, write:

```yaml
output:
  pagedown::html_paged:
    template: custom_template.html
    css:
    - custom-fonts.css
    - custom-page.css
    - custom.css
    toc: true
    self_contained: false
    csl: https://www.zotero.org/styles/apa
```

## Main content customisation

In this step, you style headers, paragraphs, footnotes...

Here, Chrome Developers Tools are your best friends. This step is quite fast and easy.

## Customization with JavaScript libraries

At some point, you may want to try some cool JavaScript libraries to enhance your content. This is a great idea! 

But the first try rarely succeeds. 

`pagedown::html_paged()` uses the Paged.js polyfill: Paged.js parses the HTML page, _destroys_ its content and builds a new paginated HTML content. Because most of JavaScript libraries work asynchronously, you have to be sure that Paged.js starts to analyze the content after others JavaScript libraries finished their jobs. 

There are two means to synchronize Paged.js with other JavaScript libraries.

**The first mean is to deactivate Paged.js auto mode**.  
You only need to insert this JavaScript line:

```js
window.PagedConfig.auto = false;
```

Then, you'll have to run Paged.js after the tier JavaScript library finished (using a callback function, for instance). The command to launch Paged.js without auto mode is:

```js
window.PagedPolyfill.preview();
```

You can find an example in this issue: https://github.com/rstudio/pagedown/issues/76

**The second mean is by using JavaScript promises/asynchronous functions**.

In its automatic mode, you can execute tier JavaScript libraries before Paged.js begins to parse the document. The `PagedConfig` JavaScript global object has a `before` key that has to be an asynchronous function (or a function returning a promise). You can use it to execute some JavaScript code before Paged.js:

```js
// retrieve the pagedown default function
const pagedownBefore = window.PagedConfig.before;
window.PagedConfig.before = async () => {
  await pagedownBefore();
  // do async operations using other JS libraries
}
```


# Bibliography {-}

```{r, include=FALSE}
knitr::write_bib(c(.packages(), 'pagedown', 'xaringan', 'servr'), 'index.bib')
```
